package integration.pipelines.declarative

node {
    stage "Configuration"
    rtServer(
            id: "Artifactory-1",
            url: "${env.JENKINS_ARTIFACTORY_URL}",
            username: "${env.JENKINS_ARTIFACTORY_USERNAME}",
            password: "${env.JENKINS_ARTIFACTORY_PASSWORD}"
    )

    stage "Upload"
    rtUpload(
            serverId: "Artifactory-1",
            buildName: "declarative-upload-test",
            buildNumber: "3",
            spec: """{
              "files": [
                {
                  "pattern": "${FILES_DIR}",
                  "target": "${LOCAL_REPO}/"
                }
             ]
            }"""
    )

    stage "Publish Build Info"
    rtPublishBuildInfo(
            serverId: "Artifactory-1",
            buildName: "declarative-upload-test",
            buildNumber: "3"
    )
}
